// eudiw-job-board Prisma schema
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_CONNECTION_STRING")
}

enum ApplicationStatus {
  CREATED
  VERIFIED
  ISSUED
}

model JobPosting {
  id           String        @id @default(cuid())
  title        String
  description  String
  createdAt    DateTime      @default(now())
  applications Application[]
}

// prisma/schema.prisma
model Application {
  id           String   @id @default(cuid())
  jobId        String
  job          JobPosting @relation(fields: [jobId], references: [id])

  status       ApplicationStatus @default(CREATED)
  
  verifierTransactionId String?  @unique
  verifierRequestUri     String?
  sameDeviceFlow        Boolean?

  // Extracted from verified credentials
  candidateFamilyName   String?
  candidateGivenName    String?
  candidateDateOfBirth  String?
  candidateNationality  String?
  candidateEmail        String?
  candidateMobilePhone  String?
  
  // Issuance
  credentialOfferUrl    String?

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([jobId])
}